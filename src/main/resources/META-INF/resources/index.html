<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<link rel="stylesheet" href="http://localhost:8080/app.css">
	</head>
	<body>
		<div class="main-content">
			<div class="inputField">
				<label class="instruction" for="username">Username</label>
				<input id="username" type="text"></input>
			</div>
			<div class="inputField">
				<label class="instruction" for="password">Password</label>
				<input id="password" type="password"></input>
			</div>
			<div class="inputField">
				<button id="login" type="button">Log In</input>
			</div>
		</div>
		
		<script type="text/javascript">
		
			var $mainContent = $(".main-content");
		
			function updateMainContent(element, index, array) {
				var characterInfo = document.createElement("div");
				var name = document.createElement("div");
				var classLevel = document.createElement("div");
				
				characterInfo.className = "character-info";
				
				name.className = "character-name";
				name.innerHTML = element.name;
				
				classLevel.className = "character-class-level";
				classLevel.innerHTML = element.level + " " + element.class;
				
				characterInfo.appendChild(name);
				characterInfo.appendChild(classLevel);
				
				$mainContent.append(characterInfo);
			}
			
			function logCharacterIn() {
			
				var characterName = this.firstChild.textContent;
			
				$.ajax({
						type: "POST",
						url: "http://localhost:8080/service/login/" + characterName,
						success: 
							function(data) {
								alert("Logged in as " + characterName);
							}
					});
			}
		
			$("#login").click(
				function() {
				
					var username = $("#username").val();
					var password = $("#password").val();
				
					$.ajax({
						type: "GET",
						url: "http://localhost:8080/service/characters",
						headers: {
    						"Authorization": "Basic " + btoa(username + ":" + password)
  						},
						success: 
							function(data) {
								$mainContent.html("");
								data.forEach(updateMainContent);
								$(".character-info").click(logCharacterIn);
							}
					});
				});
			
			
		</script>
	</body>
</html>